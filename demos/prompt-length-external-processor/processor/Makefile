APP_NAME=processor
DOCKER_IMAGE=processor:latest

.PHONY: build test docker clean help

# Default target
all: test build

# Help target
help:
	@echo "Available targets:"
	@echo "  build          - Build the processor binary"
	@echo "  test           - Run unit tests"
	@echo "  docker         - Build Docker image"
	@echo "  clean          - Clean build artifacts"
	@echo "  help           - Show this help message"

# Build the processor binary
build:
	@echo "ğŸ”¨ Building $(APP_NAME)..."
	go build -o $(APP_NAME) ./cmd/processor
	@echo "âœ… Build completed: $(APP_NAME)"

# Run tests with coverage
test:
	@echo "ğŸ§ª Running tests..."
	go test -v -race -cover ./...
	@echo "âœ… Tests completed"

# Build Docker image
docker:
	@echo "ğŸ³ Building Docker image: $(DOCKER_IMAGE)"
	docker build -t $(DOCKER_IMAGE) .
	@echo "âœ… Docker image built: $(DOCKER_IMAGE)"

# Clean build artifacts
clean:
	@echo "ğŸ§¹ Cleaning build artifacts..."
	rm -f $(APP_NAME)
	@echo "âœ… Clean completed" 